# The Shattered Kingdom - Path of Vanity

ROOT: VANITY_START

# --- The Grand Ballroom ---
NODE: VANITY_START
MSG: You enter a grand ballroom, but the sight is far from elegant. The floor is a treacherous mosaic of shattered glass. Courtiers in tattered finery limp and stumble, their faces masks of pain, each wearing a pair of ill-fitting glass slippers. At the far end of the room, on a throne of jagged mirrors, sits the Queen of Hearts, admiring a large, gleaming shard of glass.
CHOICE: "Approach the Queen directly." | target:VANITY_APPROACH_QUEEN
CHOICE: "Observe the scene from the entrance." | target:VANITY_OBSERVE
CHOICE: "Look for someone who doesn't seem to be in pain." | target:VANITY_FIND_GODMOTHER

# --- Observe the Scene ---
NODE: VANITY_OBSERVE
MSG: You watch the pained dancers. It's clear that moving across this floor is a dangerous task. You notice a pattern in the glass, a faint path where the shards are smaller and less jagged. You also see a woman in a faded, grey gown, leaning against a pillar, watching the dancers with a cynical expression. She seems to be the only one not wearing the glass slippers.
CHOICE: "Attempt to cross the floor using the safer path." | target:VANITY_CROSS_FLOOR
CHOICE: "Approach the woman in the grey gown." | target:VANITY_FIND_GODMOTHER

NODE: VANITY_CROSS_FLOOR
MSG: You carefully make your way across the floor, following the path of smaller shards. It's slow going, and you can feel the sharp edges of the glass through the soles of your shoes. You're halfway across when you slip, and a large shard of glass pierces your leg. You take 10 damage.
CHOICE: "Press on." | target:VANITY_APPROACH_QUEEN
CHOICE: "Turn back." | target:VANITY_START

# --- Find the Fairy Godmother ---
NODE: VANITY_FIND_GODMOTHER
MSG: You approach the woman in the grey gown. She looks you up and down, a wry smile on her lips. "Lost, little one? Or just here to enjoy the show? The Queen's 'Glass Slipper Gala' is the talk of the realm. A real... smash."
CHOICE: "Who are you?" | target:VANITY_GODMOTHER_WHO
CHOICE: "Why are they all wearing glass slippers?" | target:VANITY_GODMOTHER_WHY

NODE: VANITY_GODMOTHER_WHO
MSG: "They call me the Fairy Godmother," she says with a sigh. "But the magic's run a bit thin these days. All my 'bippity-boppity-boo' just seems to make things worse. Now, I just watch the stories fall apart."
CHOICE: "Can you help me? I need to get that Glass Shard from the Queen." | target:VANITY_GODMOTHER_HELP
CHOICE: "You seem... jaded." | target:VANITY_GODMOTHER_JADED

NODE: VANITY_GODMOTHER_WHY
MSG: "The Queen is obsessed with reflections," the Godmother explains. "She shattered every mirror in the kingdom except her own. Then she found Cinderella's slipper. She thinks if she can see her reflection in it, she'll be the fairest of them all. She forces everyone to wear them, hoping one will be a perfect fit."
CHOICE: "So, the shard is from Cinderella's slipper?" | target:VANITY_GODMOTHER_HELP
CHOICE: "That's insane." | target:VANITY_GODMOTHER_JADED

NODE: VANITY_GODMOTHER_JADED
MSG: "You try making wishes come true in a world where every story is a tragedy," she mutters. "It takes a toll. Now, what do you want? I haven't got all day. Or maybe I have. Time is... funny here."
CHOICE: "I need your help to get the Glass Shard." | target:VANITY_GODMOTHER_HELP

NODE: VANITY_GODMOTHER_HELP
MSG: The Fairy Godmother considers you. "Help you? Why? What's in it for me? Another shattered dream? Another hero who ends up as a footnote in someone else's tragedy?"
CHOICE: "I'm not a hero. I'm just trying to write my own story." | target:VANITY_GODMOTHER_AGREES
CHOICE: "I can offer you... a new story. A better one." | target:VANITY_GODMOTHER_AGREES
CHOICE: "I have this magic bean..." | condition:hasitem:Magic Bean | target:VANITY_GODMOTHER_BEAN

NODE: VANITY_GODMOTHER_BEAN
MSG: "A magic bean?" The Godmother's eyes light up with a flicker of old magic. "Interesting. Give it to me. In return, I'll grant you a boon. But be warned, my magic is... unpredictable."
CHOICE: "Give her the bean." | item:Unbreakable Slippers:ARMOR:0 | target:VANITY_SLIPPERS
CHOICE: "On second thought, I'll keep the bean." | target:VANITY_GODMOTHER_HELP

NODE: VANITY_GODMOTHER_AGREES
MSG: Your words seem to strike a chord with the jaded fairy. "Write your own story, eh? A novel concept. Very well. I'll help you. But you'll need to do something for me first. The Queen wants a perfect reflection? Fine. We'll give her one. Bring me the Magic Mirror from the old dwarf mines. It's the only thing that might satisfy her vanity."
CHOICE: "The Magic Mirror? Where are these mines?" | target:VANITY_MIRROR_QUEST
CHOICE: "That sounds too dangerous. There must be another way." | target:VANITY_APPROACH_QUEEN

NODE: VANITY_SLIPPERS
MSG: The Godmother takes the bean and it vanishes in a puff of smoke. She taps your feet with her wand. "There. A pair of unbreakable slippers. They won't shatter, but they're still as slippery as ever. Good luck." You can now walk across the floor without fear of injury.
CHOICE: "Thank you. Now, to the Queen." | target:VANITY_APPROACH_QUEEN

# --- Approaching the Queen ---
NODE: VANITY_APPROACH_QUEEN
MSG: You make your way to the throne. The Queen of Hearts looks down at you, her face a mask of regal contempt. "Another stray? Come to pay tribute to my beauty? Or perhaps you think you can succeed where all these fools have failed?"
CHOICE: "I've come for the Glass Shard." | target:VANITY_QUEEN_DEMAND
CHOICE: "Your Majesty, I have a gift for you." | condition:hasitem:Magic Mirror | target:VANITY_QUEEN_GIFT
CHOICE: "I challenge you for the shard!" | target:VANITY_QUEEN_FIGHT

NODE: VANITY_QUEEN_DEMAND
MSG: The Queen laughs, a sound like shattering glass. "Of course you have. Everyone wants what is mine. Off with your head!" The guards seize you, and your story ends abruptly.
CHOICE: "..." | target:END_GAME

# --- Placeholder for Mirror Quest and Combat ---
NODE: VANITY_MIRROR_QUEST
MSG: The Godmother gives you directions to the abandoned dwarf mines. This will be a separate sub-dungeon. (To be implemented)
CHOICE: "Return to the crossroads for now." | target:CROSSROADS_MAIN

NODE: VANITY_QUEEN_FIGHT
MSG: You challenge the Queen. This will trigger a combat encounter. (To be implemented)
CHOICE: "Return to the crossroads for now." | target:CROSSROADS_MAIN

NODE: VANITY_QUEEN_GIFT
MSG: You present the Magic Mirror to the Queen. Her eyes go wide with delight. "At last! A reflection worthy of my beauty!" She tosses the Glass Shard aside carelessly. You snatch it up. You have one of the three fragments!
CHOICE: "Leave the ballroom with your prize." | item:Glass Shard:QUEST_ITEM:0 | target:CROSSROADS_MAIN
